"use strict";(self.webpackChunkdocumentation_api=self.webpackChunkdocumentation_api||[]).push([[814],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=u(n),p=o,h=m["".concat(s,".").concat(p)]||m[p]||d[p]||r;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:o,i[1]=l;for(var u=2;u<r;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},3725:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>u});var a=n(7462),o=(n(7294),n(3905));const r={},i="Mobee Document Generation Module",l={unversionedId:"documentation-api/document-generator/mobee-document-generator",id:"documentation-api/document-generator/mobee-document-generator",title:"Mobee Document Generation Module",description:"User Profile Requirements and Permissions",source:"@site/docs/documentation-api/document-generator/mobee-document-generator.md",sourceDirName:"documentation-api/document-generator",slug:"/documentation-api/document-generator/mobee-document-generator",permalink:"/documentation/docs/documentation-api/document-generator/mobee-document-generator",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/documentation-api/document-generator/mobee-document-generator.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Static resources synchronization coverage",permalink:"/documentation/docs/documentation-api/Static-resources-synchronization-coverage/"},next:{title:"Mobee Installation Guide",permalink:"/documentation/docs/documentation-api/mobee-installation-guide/Installation-guide"}},s={},u=[{value:"User Profile Requirements and Permissions",id:"user-profile-requirements-and-permissions",level:2},{value:"Adding the Document Generation Action Button to a Page",id:"adding-the-document-generation-action-button-to-a-page",level:2},{value:"Preparing the Word or PowerPoint Template",id:"preparing-the-word-or-powerpoint-template",level:2},{value:"Generating Documents from the Created Template",id:"generating-documents-from-the-created-template",level:2},{value:"Adding an Image to the Document",id:"adding-an-image-to-the-document",level:2},{value:"Base64 Image",id:"base64-image",level:3},{value:"URL Image",id:"url-image",level:3},{value:"Usage Rules",id:"usage-rules",level:2},{value:"Tag Types",id:"tag-types",level:3},{value:"Filters and Utilities",id:"filters-and-utilities",level:3}],c={toc:u},m="wrapper";function d(e){let{components:t,...r}=e;return(0,o.kt)(m,(0,a.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"mobee-document-generation-module"},"Mobee Document Generation Module"),(0,o.kt)("h2",{id:"user-profile-requirements-and-permissions"},"User Profile Requirements and Permissions"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The user must meet three of the following requirements to use the module:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"A Mobee license."),(0,o.kt)("li",{parentName:"ul"},'"Mobee User" or "Mobee Administrator" permission set.'),(0,o.kt)("li",{parentName:"ul"},'Active "Flow User" option.')))),(0,o.kt)("h2",{id:"adding-the-document-generation-action-button-to-a-page"},"Adding the Document Generation Action Button to a Page"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},'Go to the object where you want the generation button to be available, then navigate to the "Buttons, Links, and Actions" section to add a new action.'),(0,o.kt)("li",{parentName:"ol"},'Choose the "Lightning Web Component" option for the "Action Type," then select the "Mobee:documentGeneratorAction" option for the "Lightning Web Component."\n',(0,o.kt)("img",{alt:"Sample Image",src:n(4823).Z,width:"512",height:"506"}),(0,o.kt)("br",null)),(0,o.kt)("li",{parentName:"ol"},'Once the action button is created, you\'ll need to add it to a desired "Page Layout."\n',(0,o.kt)("img",{alt:"Sample Image",src:n(3972).Z,width:"512",height:"391"}),(0,o.kt)("br",null))),(0,o.kt)("h2",{id:"preparing-the-word-or-powerpoint-template"},"Preparing the Word or PowerPoint Template"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Creating a document template in Salesforce:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},'Go to the "Mobee Documents Templates" page to create a new template.'),(0,o.kt)("li",{parentName:"ul"},'Click the "New" button and provide a name for the template.\n',(0,o.kt)("img",{alt:"Sample Image",src:n(9895).Z,width:"512",height:"506"}),(0,o.kt)("br",null)),(0,o.kt)("li",{parentName:"ul"},'Once the template is created, you\'ll need to associate it with a Salesforce object by clicking the "Choose Main Object" button.'),(0,o.kt)("li",{parentName:"ul"},"The object can be selected using the search field.\n",(0,o.kt)("img",{alt:"Sample Image",src:n(2871).Z,width:"512",height:"506"}),(0,o.kt)("br",null)),(0,o.kt)("li",{parentName:"ul"},"The first step should now be completed, and you can proceed to download your Word document template in the second step.",(0,o.kt)("br",null),"![Sample Image](./img/prep_word3.png)",(0,o.kt)("br",null))))),(0,o.kt)("h2",{id:"generating-documents-from-the-created-template"},"Generating Documents from the Created Template"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Navigate to a record of the same object type as the created document template."),(0,o.kt)("li",{parentName:"ol"},"Click the Generate Document action button."),(0,o.kt)("li",{parentName:"ol"},"Select the desired template from the selection list."),(0,o.kt)("li",{parentName:"ol"},"The document should be generated and automatically downloaded.\n",(0,o.kt)("img",{alt:"Sample Image",src:n(6716).Z,width:"512",height:"506"}),(0,o.kt)("br",null))),(0,o.kt)("h2",{id:"adding-an-image-to-the-document"},"Adding an Image to the Document"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'You can include images in your generated documents using dynamic placeholders. For instance, if you have an image field named "Profile_Picture" in your Salesforce object, you can add it to your document using the following tag: ',(0,o.kt)("inlineCode",{parentName:"li"},"{% Profile_Picture }"),".Users have the flexibility to choose between two methods to provide the image: using base64 data or providing a URL.")),(0,o.kt)("h3",{id:"base64-image"},"Base64 Image"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"To include an image using base64 data, simply encode the image into base64 format and insert it directly into your salesforce object.")),(0,o.kt)("h3",{id:"url-image"},"URL Image"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"To include an image using a URL, follow these steps:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},'If the image URL is "',(0,o.kt)("a",{parentName:"p",href:"https://i.imgur.com/JpA66EI.png,%22"},'https://i.imgur.com/JpA66EI.png,"')," you need to set up remote site settings to ensure secure retrieval of the image:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},' 1. Go to "Setup" in Salesforce.\n 2. In the quick find box, search for "Remote Site Settings" and select it.\n 3. Click the "New Remote Site" button.\n 4. Provide a name for the site (e.g., "Imgur Site").\n 5. In the "Remote Site URL" field, enter the base URL of the image\'s location, in this case, "https://i.imgur.com."\n 6. Check the "Disable Protocol Security" checkbox to allow retrieval over HTTP.\n 7. Click "Save."\n')),(0,o.kt)("br",null),"![Sample Image](./img/remote_site.PNG)",(0,o.kt)("br",null)),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Now, you need to add the URL to the trusted URLs with all CSP (Content Security Policy) directives enabled:"),(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},'find the "Trusted URLs" in the quick find box.'),(0,o.kt)("li",{parentName:"ol"},'Click the "New Trusted Site" button.'),(0,o.kt)("li",{parentName:"ol"},'Provide a name for the trusted site (e.g., "Imgur Trusted").'),(0,o.kt)("li",{parentName:"ol"},'In the "Site URL" field, enter the same base URL as before, "',(0,o.kt)("a",{parentName:"li",href:"https://i.imgur.com.%22"},'https://i.imgur.com."')),(0,o.kt)("li",{parentName:"ol"},'Check all CSP directives: "Connect," "Font," "Img," "Media," "Object," "Script," "Style."'),(0,o.kt)("li",{parentName:"ol"},'Click "Save." ',(0,o.kt)("br",null),"![Sample Image](./img/trusted_url.PNG)",(0,o.kt)("br",null),(0,o.kt)("br",null),"![Sample Image](./img/trusted_url2.PNG)",(0,o.kt)("br",null)))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"You have now set up remote site settings and trusted URLs to securely retrieve the image over HTTP. You can then use the ",(0,o.kt)("inlineCode",{parentName:"p"},"{% Profile_Picture}")," tag to dynamically include the image in your generated documents."))))),(0,o.kt)("h2",{id:"usage-rules"},"Usage Rules"),(0,o.kt)("h3",{id:"tag-types"},"Tag Types"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The document generation module accepts any Word document."),(0,o.kt)("li",{parentName:"ul"},"Tag syntax is inspired by Mustache annotation. Normal tags start with an alphabetic character, while other tag types start with special prefixes. For example:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"{#loop} and {/} to start and end a loop for iterating through data lists."))),(0,o.kt)("li",{parentName:"ul"},'Logical expressions also start with the "#" character and support the following operators:')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-md"},'  - AND a && b\n  - OR a || b\n  - ADDITION a + b\n  - SUBTRACTION a - b\n  - MULTIPLICATION a * b\n  - MODULO a % b\n  - DIVISION a / b\n  - TERNARY a ? b : c\n  - ASSIGNMENT a = 1\n  - EQUALITY/INEQUALITY a == 1, a != 1\n  - RELATIONAL a > 1, a < 1, a >= 1, a <= 1\n  - OPERATOR PRECEDENCE with parentheses (a && b) || c\n  - EXPONENTIAL NOTATION: 12e3 => returns 12000\n- Example:\n  - {#products.length > 1}\n    - There are multiple products\n  - {/}\n  - {#firstName == "John"}\n    - Hello John\n  - {/}\n  - The first condition will display the section only if there are 2 or more products.\n  - The second condition will display the section only if the username is the string "John".\n')),(0,o.kt)("h3",{id:"filters-and-utilities"},"Filters and Utilities"),(0,o.kt)("p",null,"Mobee provides several features to help users customize their documents."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'To get the current date, you can use the value "docUtils.today".')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-md"},"    - Today is {docUtils.today}\n- Here are the supported filters:\n  - lower: A function that converts text to lowercase.\n  - upper: A function that converts text to uppercase.\n  - shortDate: A function that returns the date in a short format.\n  - followingMonth: A function that returns the next month from a given date.\n  - followingYear: A function that returns the next year from a given date.\n  - lastWorkingDayOfMonth: A function that returns the last working day of the month from a given date.\n  - formatDate: A general function for calculating date values.\n- Usage example:\n  - The created date is {CreatedDate | shortDate}\n  - The following month is {CreatedDate | followingMonth: '[[ \"year\": \"numeric\", \"month\": \"long\" ]]'}\n  - The next year is {CreatedDate | followingYear: '[[ \"year\": \"numeric\"]]'}\n  - The last working day of the month is {CreatedDate | lastWorkingDayOfMonth}\n- The followingMonth, followingYear, lastWorkingDayOfMonth, and formatDate functions accept the following formatting options:\n  - [[\n  weekday: 'narrow' | 'short' | 'long',\n  era: 'narrow' | 'short' | 'long',\n  year: 'numeric' | '2-digit',\n  month: 'numeric' | '2-digit' | 'narrow' | 'short' | 'long',\n  day: 'numeric' | '2-digit',\n  hour: 'numeric' | '2-digit',\n  minute: 'numeric' | '2-digit',\n  second: 'numeric' | '2-digit',\n  timeZoneName: 'short' | 'long',\n\n  // Time zone to express it in\n  timeZone: 'Asia/Shanghai',\n  // Force 12-hour or 24-hour\n  hour12: true | false,\n\n  // Rarely-used options\n  hourCycle: 'h11' | 'h12' | 'h23' | 'h24',\n  formatMatcher: 'basic' | 'best fit'\n]]\n")))}d.isMDXComponent=!0},4823:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ajouter_button_action-38573f0fbce30daf6d82c60a65a5f3ae.png"},3972:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ajouter_button_action2-375cc7bad4d2da77a2999b1a560c7b8b.jpg"},6716:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/generer_apartir_modele_creer-734a9631d1ef71cbed3a34a5defe2e43.png"},9895:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/prep_word-cc5c8fa27853fb696acf97c7fba16d35.png"},2871:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/prep_word2-76b095e68c22be42dc1d3b250fb06c02.png"}}]);